<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Megumi's Usagi Cafe | ÂÖéËå∂Â∫ó</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cherry+Bomb+One&family=Outfit:wght@300;400;500;600;700&family=Zen+Maru+Gothic:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Floating Boba Particles Background -->
    <div class="boba-particles" id="bobaParticles"></div>

    <!-- ============================================
         CAFE VIEWPORT - The "Game World"
         ============================================ -->
    <div class="cafe-viewport" id="cafeViewport">

        <!-- OUTSIDE SCENE (Storefront) -->
        <section class="cafe-scene cafe-outside" id="sceneOutside">
            <!-- Background Image -->
            <div class="scene-bg"></div>

            <!-- Content Overlay -->
            <div class="scene-content">
                <div class="hero-panel">
                    <div class="hero-mascot">
                        <img src="images/logo_hero.svg" alt="ÂÖéËå∂Â∫ó" class="hero-mascot-img animate-float">
                    </div>
                    <div class="hero-content">
                        <div class="hero-title">
                            <span class="title-en">Megumi's Usagi Cafe</span>
                        </div>
                        <p class="hero-desc">Bubble tea & bunny friends. Collect stamps, meet our rabbits, unlock exclusive goodies.</p>
                        <div class="hero-actions">
                            <button class="btn btn-primary btn-enter" data-location="inside">
                                <span>Enter the Cafe</span>
                                <span class="btn-icon">üö™</span>
                            </button>
                        </div>
                        <img src="images/logo_mascot_ink.svg" alt="Megumi" class="hero-logo-img">
                        <p class="hero-tagline">i bite.</p>
                    </div>

                    <!-- Cafe Options -->
                    <div class="cafe-options">
                        <button class="cafe-option-btn" onclick="openRankingsModal()">
                            <span class="option-icon">üèÜ</span>
                            <span class="option-label">Rankings</span>
                        </button>
                        <button class="cafe-option-btn" onclick="openFeaturedModal()">
                            <span class="option-icon">‚≠ê</span>
                            <span class="option-label">Featured</span>
                        </button>
                        <button class="cafe-option-btn" onclick="openTrendingModal()">
                            <span class="option-icon">üî•</span>
                            <span class="option-label">Trending</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- INSIDE SCENE (Cafe Interior) -->
        <section class="cafe-scene cafe-inside" id="sceneInside">
            <!-- Ambient floating buns decoration -->
            <div class="ambient-buns" id="ambientBuns"></div>

            <!-- Background Image -->
            <div class="scene-bg"></div>

            <!-- Content Overlay -->
            <div class="scene-content">
                <div class="inside-panel">
                    <h2 class="inside-title">Welcome Inside</h2>
                    <p class="inside-subtitle">What would you like to do?</p>

                    <!-- Action Grid -->
                    <div class="inside-actions-grid">
                        <button class="inside-action-card" data-action="open-phone" data-app="menu">
                            <span class="inside-action-icon">üßã</span>
                            <span class="inside-action-label">Order Drinks</span>
                        </button>
                        <button class="inside-action-card" data-action="open-phone" data-app="menu" data-section="buns">
                            <span class="inside-action-icon">üê∞</span>
                            <span class="inside-action-label">Meet Buns</span>
                        </button>
                        <button class="inside-action-card" data-action="schedule">
                            <span class="inside-action-icon">ü™ë</span>
                            <span class="inside-action-label">Book Visit</span>
                        </button>
                        <button class="inside-action-card" data-action="open-phone" data-app="passport">
                            <span class="inside-action-icon">üìî</span>
                            <span class="inside-action-label">Passport</span>
                        </button>
                    </div>

                    <button class="btn btn-secondary btn-exit" data-location="outside">
                        <span class="btn-icon">üö™</span>
                        <span>Exit Cafe</span>
                    </button>
                </div>
            </div>
        </section>
    </div>

    <!-- ============================================
         PHONE UI - Smartphone with Apps
         ============================================ -->
    <div class="phone-backdrop" id="phoneBackdrop"></div>

    <!-- Modal backdrop (shared by all modals) -->
    <div class="modal-backdrop" id="modalBackdrop"></div>

    <div class="phone" id="phone">
        <div class="phone-frame">
            <div class="phone-screen">

                <!-- MENU APP -->
                <div class="phone-app" id="phoneAppMenu" data-app="menu">
                    <div class="phone-app__header">
                        <h2 class="app-title">Menu & Buns</h2>
                        <p class="app-subtitle">Order drinks, meet the residents</p>
                    </div>

                    <!-- Cafe Navigation Tabs -->
                    <div class="phone-app__tabs cafe-tabs">
                        <button class="cafe-tab active" data-cafe-section="buns">
                            <span class="cafe-tab-icon">üê∞</span>
                            <span class="cafe-tab-label">Buns</span>
                        </button>
                        <button class="cafe-tab" data-cafe-section="drinks">
                            <span class="cafe-tab-icon">üßã</span>
                            <span class="cafe-tab-label">Drinks</span>
                        </button>
                        <button class="cafe-tab" data-cafe-section="snacks">
                            <span class="cafe-tab-icon">üç°</span>
                            <span class="cafe-tab-label">Snacks</span>
                        </button>
                        <button class="cafe-tab" data-cafe-section="rewards">
                            <span class="cafe-tab-icon">‚≠ê</span>
                            <span class="cafe-tab-label">Rewards</span>
                        </button>
                    </div>

                    <div class="phone-app__body">
                        <!-- BUNS SECTION -->
                        <div class="cafe-section cafe-buns active" id="cafeBuns">
                            <div class="section-intro">
                                <p>Spend time with our fluffy residents! Book a visit, give treats, and build lasting friendships.</p>
                            </div>
                            <div class="rabbits-grid" id="rabbitsGrid">
                                <!-- Rabbit cards populated by JS -->
                            </div>
                        </div>

                        <!-- DRINKS SECTION -->
                        <div class="cafe-section cafe-drinks" id="cafeDrinks">
                            <div class="section-intro">
                                <p>Handcrafted with love (and a little spite). Each drink earns you a stamp!</p>
                            </div>
                            <div class="menu-filters">
                                <button class="filter-btn active" data-filter="all">All</button>
                                <button class="filter-btn" data-filter="signature">Signature</button>
                                <button class="filter-btn" data-filter="classic">Classic</button>
                                <button class="filter-btn" data-filter="yogurt">Rice Yogurt</button>
                                <button class="filter-btn" data-filter="seasonal">Seasonal</button>
                            </div>
                            <div class="menu-grid" id="menuGrid">
                                <!-- Drinks populated by JS -->
                            </div>
                        </div>

                        <!-- SNACKS SECTION -->
                        <div class="cafe-section cafe-snacks" id="cafeSnacks">
                            <div class="section-intro">
                                <p>Pair with your drink or grab for the road. Perfect companions for bun watching!</p>
                            </div>
                            <div class="snacks-grid" id="snacksGrid">
                                <!-- Snacks populated by JS -->
                            </div>
                        </div>

                        <!-- REWARDS SECTION -->
                        <div class="cafe-section cafe-rewards" id="cafeRewards">
                            <div class="section-intro">
                                <div class="rewards-balance">
                                    <span class="rewards-balance-icon">‚≠ê</span>
                                    <span class="rewards-balance-amount" id="rewardsBalance">0</span>
                                    <span class="rewards-balance-label">stamps to spend</span>
                                </div>
                                <p>Redeem your stamps for exclusive cafe goodies! Add items to cart and checkout.</p>
                            </div>
                            <div class="rewards-grid" id="rewardsGrid">
                                <!-- Rewards items populated by JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PASSPORT APP -->
                <div class="phone-app active" id="phoneAppPassport" data-app="passport">
                    <!-- First-time Onboarding -->
                    <div class="passport-onboarding" id="passportOnboarding">
                        <div class="onboarding-content">
                            <span class="onboarding-icon">üìî</span>
                            <h2>Welcome to Your Cafe Passport!</h2>
                            <p>Set up your profile to start collecting stamps and stickers.</p>
                            <div class="onboarding-form">
                                <div class="form-group">
                                    <label class="form-label">Your Name</label>
                                    <input type="text" id="onboardingName" class="form-input" placeholder="Enter your name" maxlength="20">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Choose Your Avatar</label>
                                    <div class="avatar-picker" id="onboardingAvatarPicker">
                                        <button class="avatar-option active" data-avatar="üê∞">üê∞</button>
                                        <button class="avatar-option" data-avatar="üêá">üêá</button>
                                        <button class="avatar-option" data-avatar="üßã">üßã</button>
                                        <button class="avatar-option" data-avatar="üçµ">üçµ</button>
                                        <button class="avatar-option" data-avatar="‚≠ê">‚≠ê</button>
                                        <button class="avatar-option" data-avatar="üå∏">üå∏</button>
                                        <button class="avatar-option" data-avatar="üíñ">üíñ</button>
                                        <button class="avatar-option" data-avatar="üéÄ">üéÄ</button>
                                        <button class="avatar-option" data-avatar="‚ú®">‚ú®</button>
                                        <button class="avatar-option" data-avatar="üåô">üåô</button>
                                        <button class="avatar-option" data-avatar="üç°">üç°</button>
                                        <button class="avatar-option" data-avatar="ü•ï">ü•ï</button>
                                    </div>
                                </div>
                                <button class="btn btn-primary btn-full" id="onboardingComplete">Start My Journey</button>
                            </div>
                        </div>
                    </div>

                    <!-- Main Passport Content (for returning users) -->
                    <div class="passport-main" id="passportMain">
                        <!-- Stats & Progress Overview (Header Zone) -->
                        <div class="phone-app__header passport-overview">
                            <div class="passport-stats-bar">
                                <div class="stat-chip">
                                    <span class="stat-chip-icon">üçµ</span>
                                    <span class="stat-chip-value" id="passportDrinks">0</span>
                                    <span class="stat-chip-label">drinks</span>
                                </div>
                                <div class="stat-chip">
                                    <span class="stat-chip-icon">üêá</span>
                                    <span class="stat-chip-value" id="passportVisits">0</span>
                                    <span class="stat-chip-label">visits</span>
                                </div>
                                <div class="stat-chip">
                                    <span class="stat-chip-icon">‚≠ê</span>
                                    <span class="stat-chip-value" id="passportStamps">0</span>
                                    <span class="stat-chip-label">stamps</span>
                                </div>
                                <div class="stat-chip">
                                    <span class="stat-chip-icon">üèÜ</span>
                                    <span class="stat-chip-value" id="passportAchievements">0</span>
                                    <span class="stat-chip-label">stickers</span>
                                </div>
                            </div>
                            <div class="passport-progress-row">
                                <div class="progress-item">
                                    <span class="progress-item-label">Next Reward:</span>
                                    <span class="progress-item-name" id="passportNextReward">-</span>
                                    <div class="progress-bar-mini">
                                        <div class="progress-bar-fill" id="passportRewardProgress" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-item-text" id="passportRewardText">0/0</span>
                                </div>
                                <div class="progress-item">
                                    <span class="progress-item-label">Best Bun:</span>
                                    <span class="progress-item-name" id="passportBestBun">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="phone-app__body passport-layout">
                            <!-- Left Sidebar: Profile -->
                            <aside class="passport-sidebar">
                                <!-- User Profile -->
                                <div class="passport-profile">
                                    <div class="passport-avatar" id="profileAvatar">üê∞</div>
                                    <div class="passport-name" id="profileName">Guest</div>
                                    <button class="passport-edit-btn" id="profileEditBtn">Edit</button>
                                    <div class="passport-stats">
                                        <div class="passport-stat">
                                            <span class="passport-stat-value" id="profileStamps">0</span>
                                            <span class="passport-stat-label">Stamps</span>
                                        </div>
                                        <div class="passport-stat">
                                            <span class="passport-stat-value" id="profileVisits">0</span>
                                            <span class="passport-stat-label">Visits</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Collection Stats -->
                                <div class="passport-collection-stats">
                                    <h4>Collection Progress</h4>
                                    <div class="collection-stat-row">
                                        <span>Stamps</span>
                                        <span id="collectionStamps">0</span>
                                    </div>
                                    <div class="collection-stat-row">
                                        <span>Bun Stickers</span>
                                        <span id="collectionBuns">0 / 65</span>
                                    </div>
                                    <div class="collection-stat-row">
                                        <span>Achievements</span>
                                        <span id="collectionAchievements">0 / 40</span>
                                    </div>
                                    <div class="collection-stat-row">
                                        <span>Shop Items</span>
                                        <span id="collectionItems">0 / 8</span>
                                    </div>
                                </div>
                            </aside>

                            <!-- Main Canvas Area -->
                            <div class="passport-canvas-wrapper">
                                <div class="canvas-header">
                                    <h2 class="canvas-title">Cafe Passport</h2>
                                    <div class="canvas-tabs">
                                        <button class="canvas-tab active" data-canvas-view="all">All</button>
                                        <button class="canvas-tab" data-canvas-view="stamps">Stamps</button>
                                        <button class="canvas-tab" data-canvas-view="buns">Buns</button>
                                        <button class="canvas-tab" data-canvas-view="achievements">Stickers</button>
                                        <button class="canvas-tab" data-canvas-view="items">Items</button>
                                    </div>
                                </div>
                                <div class="passport-canvas" id="passportCanvas">
                                    <!-- Draggable collectibles rendered here by JS -->
                                    <div class="canvas-empty" id="canvasEmpty">
                                        <span class="canvas-empty-icon">üìî</span>
                                        <p class="canvas-empty-text">Your passport is empty!</p>
                                        <p class="canvas-empty-hint">Order drinks to earn stamps, visit buns to unlock friendship stickers.</p>
                                        <button class="btn btn-primary" data-action="switch-app" data-app="menu">Start Collecting</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CART APP -->
                <div class="phone-app" id="phoneAppCart" data-app="cart">
                    <div class="phone-app__header">
                        <h2 class="app-title">Your Order</h2>
                        <p class="app-subtitle">Ready when you are</p>
                    </div>

                    <div class="phone-app__body cart-items" id="cartItems">
                        <!-- Cart items populated by JS -->
                        <div class="cart-empty" id="cartEmpty">
                            <span class="cart-empty-icon">üßã</span>
                            <p class="cart-empty-text">Your cart is empty</p>
                            <button class="btn btn-secondary" data-action="switch-app" data-app="menu">Browse Menu</button>
                        </div>
                    </div>

                    <div class="phone-app__footer cart-footer" id="cartFooter">
                        <div class="cart-summary" id="cartSummary">
                            <!-- Order summary populated by JS -->
                        </div>
                        <div class="cart-pickup">
                            <label for="pickupTime">Pickup Time</label>
                            <input type="datetime-local" id="pickupTime" class="pickup-input">
                        </div>
                        <button class="btn btn-primary btn-full" id="checkoutBtn">
                            <span class="checkout-text">Place Order</span>
                            <span class="checkout-total" id="checkoutTotal">$0.00</span>
                        </button>
                        <p class="cart-note">
                            <span class="cart-note-icon">‚≠ê</span>
                            <span id="stampsPreview">+0 stamps with this order!</span>
                        </p>
                    </div>

                    <!-- Order Success Overlay -->
                    <div class="cart-success" id="cartSuccess">
                        <div class="cart-success-content">
                            <span class="success-icon">üéâ</span>
                            <h3>Order Placed!</h3>
                            <p class="success-stamps" id="successStamps"></p>
                            <p class="success-message">See you soon!</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Phone Tab Bar -->
            <nav class="phone-tabs">
                <button class="phone-tab active" data-app="passport" data-icon="üìî">Passport</button>
                <button class="phone-tab" data-app="menu" data-icon="üçµ">Menu</button>
                <button class="phone-tab" data-app="cart" data-icon="üõí">
                    Cart
                    <span class="tab-badge" id="cartBadge"></span>
                </button>
            </nav>
        </div>
    </div>

    <!-- ============================================
         UNIVERSAL MODAL - Single modal for all content
         ============================================ -->
    <div class="modal" id="appModal">
        <div class="modal-content">
            <button class="modal-close" aria-label="Close">&times;</button>
            <div class="modal-body">
                <!-- All content populated by JS -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-close-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- ============================================
         BOTTOM BAR - Game Controls
         ============================================ -->
    <nav class="bottom-bar" id="bottomBar">
        <div class="bottom-bar-logo">
            <a href="#" data-location="outside">
                <img src="images/logo_hero_2.svg" alt="Megumi's Usagi Cafe" class="logo-icon">
            </a>
        </div>
        <div class="bottom-bar-center">
            <button class="location-btn active" data-location="outside" id="btnOutside">
                <span class="location-icon">üè†</span>
                <span class="location-label">Outside</span>
            </button>
            <button class="location-btn" data-location="inside" id="btnInside">
                <span class="location-icon">üè™</span>
                <span class="location-label">Inside</span>
            </button>
        </div>
        <div class="bottom-bar-right">
            <button class="phone-toggle" id="phoneToggle">
                üì±
                <span class="cart-badge" id="phoneCartBadge"></span>
            </button>
        </div>
    </nav>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="js/data.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
